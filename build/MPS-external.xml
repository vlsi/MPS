<project name="MPS-external" default="main" basedir="..">
  <property file="${ant.file}/../MPS.properties" />
  <fail unless="build.number" message="Property build.number unspecified." />
  <fail unless="build.vcs.number" message="Property build.vcs.number unspecified." />
  <fail unless="version" message="Property version unspecified." />
  <fail unless="teamcity.buildConfName" message="Property teamcity.buildConfName unspecified." />
  <import file="${ant.file}/../MPS-compile.xml" />
  <import file="${ant.file}/../help-build.xml" />
  <import file="${ant.file}/../MPS-external.xml" />
  <import file="${ant.file}/../MPS-languages.xml" />
  <target name="main" depends="compile,clean.before,folders.create,do.the.job,clean.after" />
  <target name="compile">
    <antcall target="compile.all" />
  </target>
  <target name="clean.before" depends="compile">
    <delete dir="${deploy.dir}" />
    <tstamp />
  </target>
  <target name="folders.create" depends="clean.before">
    <mkdir dir="${deploy.dir}" />
    <mkdir dir="${deploy.dir}/MPS/bin" />
    <mkdir dir="${deploy.dir}/MPS/lib/beansbinding" />
    <mkdir dir="${deploy.dir}/MPS/lib/ant-1.7.0" />
    <mkdir dir="${deploy.dir}/MPS/lib/asm" />
    <mkdir dir="${deploy.dir}/MPS/lib/commons-codec" />
    <mkdir dir="${deploy.dir}/MPS/lib/commons-collections" />
    <mkdir dir="${deploy.dir}/MPS/lib/commons-lang" />
    <mkdir dir="${deploy.dir}/MPS/lib/commons-logging" />
    <mkdir dir="${deploy.dir}/MPS/lib/commons-net" />
    <mkdir dir="${deploy.dir}/MPS/lib/eclipse-compiler" />
    <mkdir dir="${deploy.dir}/MPS/lib/javahelp" />
    <mkdir dir="${deploy.dir}/MPS/lib/jdom" />
    <mkdir dir="${deploy.dir}/MPS/lib/jgoodies" />
    <mkdir dir="${deploy.dir}/MPS/lib/jetbrains-ideframework" />
    <mkdir dir="${deploy.dir}/MPS/lib/jna" />
    <mkdir dir="${deploy.dir}/MPS/lib/jmock2.4" />
    <mkdir dir="${deploy.dir}/MPS/lib/joda-time" />
    <mkdir dir="${deploy.dir}/MPS/lib/junit4" />
    <mkdir dir="${deploy.dir}/MPS/lib/log4j" />
    <mkdir dir="${deploy.dir}/MPS/lib/microba" />
    <mkdir dir="${deploy.dir}/MPS/lib/nanoxml" />
    <mkdir dir="${deploy.dir}/MPS/lib/oromatcher" />
    <mkdir dir="${deploy.dir}/MPS/lib/picocontainer" />
    <mkdir dir="${deploy.dir}/MPS/lib/trove4j" />
    <mkdir dir="${deploy.dir}/MPS/lib/xmlrpc" />
    <mkdir dir="${deploy.dir}/MPS/lib/xstream" />
    <mkdir dir="${deploy.dir}/MPS/lib/yjp" />
    <mkdir dir="${deploy.dir}/MPS/lib/httpclient" />
    <mkdir dir="${deploy.dir}/MPS/lib/tools" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/core" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/platform" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/plugin" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/resources" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/workbench" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources" />
    <mkdir dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" />
    <mkdir dir="${deploy.dir}/MPS/lib/idea-patch.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS/lib/mps.jar.tmp/idea" />
    <mkdir dir="${deploy.dir}/MPS/lib/mps.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS/lib" />
    <mkdir dir="${deploy.dir}/MPS/license" />
    <mkdir dir="${deploy.dir}/MPS/plugins" />
    <mkdir dir="${deploy.dir}/MPS/samples.zip.tmp/MPSSamples" />
    <mkdir dir="${deploy.dir}/MPS/samples.zip.tmp" />
    <mkdir dir="${deploy.dir}/MPS/core/baseLanguage" />
    <mkdir dir="${deploy.dir}/MPS/core/languageDesign" />
    <mkdir dir="${deploy.dir}/MPS/core/devkits" />
    <mkdir dir="${deploy.dir}/MPS/core" />
    <mkdir dir="${deploy.dir}/MPS/platform/generate.ant.task.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS/platform" />
    <mkdir dir="${deploy.dir}/MPS/plugin" />
    <mkdir dir="${deploy.dir}/MPS/workbench" />
    <mkdir dir="${deploy.dir}/MPS/custom-fields-rest" />
    <mkdir dir="${deploy.dir}/MPS/youtrack-workflow" />
    <mkdir dir="${deploy.dir}/MPS/help-build.append.idea.version" />
    <mkdir dir="${deploy.dir}/MPS" />
    <mkdir dir="${deploy.dir}/MPS-buildTools.zip.tmp/tools" />
    <mkdir dir="${deploy.dir}/MPS-buildTools.zip.tmp/resources" />
    <mkdir dir="${deploy.dir}/MPS-buildTools.zip.tmp" />
    <mkdir dir="${deploy.dir}/help-build.pack.mps.src" />
  </target>
  <target name="do.the.job" depends="folders.create">
    <fail unless="mps_home" message="Property mps_home unspecified." />
    <copy todir="${deploy.dir}/MPS/bin">
      <fileset dir="${mps_home}/bin" excludes="**/*.hprof, **/*.iml, **/*.iws" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/beansbinding">
      <fileset dir="${mps_home}/lib/beansbinding" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/ant-1.7.0">
      <fileset dir="${mps_home}/lib/ant-1.7.0" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/asm">
      <fileset dir="${mps_home}/lib/asm" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/commons-codec">
      <fileset dir="${mps_home}/lib/commons-codec" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/commons-collections">
      <fileset dir="${mps_home}/lib/commons-collections" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/commons-lang">
      <fileset dir="${mps_home}/lib/commons-lang" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/commons-logging">
      <fileset dir="${mps_home}/lib/commons-logging" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/commons-net">
      <fileset dir="${mps_home}/lib/commons-net" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/eclipse-compiler">
      <fileset dir="${mps_home}/lib/eclipse-compiler" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/javahelp">
      <fileset dir="${mps_home}/lib/javahelp" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/jdom">
      <fileset dir="${mps_home}/lib/jdom" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/jgoodies">
      <fileset dir="${mps_home}/lib/jgoodies" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/jetbrains-ideframework">
      <fileset dir="${mps_home}/lib/jetbrains-ideframework" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/jna">
      <fileset dir="${mps_home}/lib/jna" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/jmock2.4">
      <fileset dir="${mps_home}/lib/jmock2.4" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/joda-time">
      <fileset dir="${mps_home}/lib/joda-time" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/junit4">
      <fileset dir="${mps_home}/lib/junit4" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/log4j">
      <fileset dir="${mps_home}/lib/log4j" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/microba">
      <fileset dir="${mps_home}/lib/microba" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/nanoxml">
      <fileset dir="${mps_home}/lib/nanoxml" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/oromatcher">
      <fileset dir="${mps_home}/lib/oromatcher" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/picocontainer">
      <fileset dir="${mps_home}/lib/picocontainer" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/trove4j">
      <fileset dir="${mps_home}/lib/trove4j" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/xmlrpc">
      <fileset dir="${mps_home}/lib/xmlrpc" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/xstream">
      <fileset dir="${mps_home}/lib/xstream" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/yjp">
      <fileset dir="${mps_home}/lib/yjp" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/httpclient">
      <fileset dir="${mps_home}/lib/httpclient" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/tools">
      <fileset dir="${mps_home}/lib/tools" excludes="**/*.zip, **/*.iml, **/*.iws" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp">
      <fileset dir="${mps_home}/source" excludes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp">
      <fileset dir="${mps_home}/tests" excludes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/core">
      <fileset dir="${mps_home}/core" excludes="**/sandbox/**, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java, **/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/platform">
      <fileset dir="${mps_home}/platform" excludes="**/sandbox/**, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java, **/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/plugin">
      <fileset dir="${mps_home}/plugin" excludes="**/sandbox/**, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java, **/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/resources">
      <fileset dir="${mps_home}/resources" excludes="**/sandbox/**, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java, **/*.java" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources/workbench">
      <fileset dir="${mps_home}/workbench" excludes="**/sandbox/**, **/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java, **/*.java" />
    </copy>
    <antcall target="help-build.repack.sources" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources" />
      <param name="output.dir" value="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" />
      <param name="basedir" value="${basedir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp/help-build.repack.sources" />
    <zip destfile="${deploy.dir}/MPS/lib/MPS-src.zip" duplicate="preserve" filesonly="true">
      <zipfileset dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" excludes="**/*.jar, **/*.class, **/*.png, **/*.xml, **/*.txt, **/*.html" includes="**/*.java" />
    </zip>
    <delete dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" />
    <copy file="${mps_home}/lib/jetbrains-ideframework/idea-external-src.zip" tofile="${deploy.dir}/MPS/lib/IDEA-src.zip" />
    <copy todir="${deploy.dir}/MPS/lib/idea-patch.jar.tmp">
      <fileset dir="${mps_home}/core/idea-patch/classes" />
    </copy>
    <jar destfile="${deploy.dir}/MPS/lib/idea-patch.jar" duplicate="preserve" filesonly="true">
      <fileset dir="${deploy.dir}/MPS/lib/idea-patch.jar.tmp" />
    </jar>
    <delete dir="${deploy.dir}/MPS/lib/idea-patch.jar.tmp" />
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/classes" excludes="production/, test/, " />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/workbench/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/javaParser/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/kernel/debug/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/kernel/debug-api/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/kernel/xmlQuery/runtime/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/kernel/classes" excludes="idea/MPSApplicationInfo.xml, " />
    </copy>
    <antcall target="replace_a7a13b0" />
    <mkdir dir="${deploy.dir}/MPS/lib/mps.jar.tmp/idea" />
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/core/runtime/classes" />
    </copy>
    <copy todir="${deploy.dir}/MPS/lib/mps.jar.tmp">
      <fileset dir="${mps_home}/MPSPlugin/MPSSupport/classes" />
    </copy>
    <jar destfile="${deploy.dir}/MPS/lib/mps.jar" duplicate="preserve" filesonly="true">
      <fileset dir="${deploy.dir}/MPS/lib/mps.jar.tmp" />
    </jar>
    <delete dir="${deploy.dir}/MPS/lib/mps.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS/lib" />
    <copy todir="${deploy.dir}/MPS/license">
      <fileset dir="${mps_home}/license" excludes="**/*.iml, **/*.iws" />
    </copy>
    <copy todir="${deploy.dir}/MPS/plugins">
      <fileset dir="${mps_home}/plugins" excludes="**/*.zip, **/*.iml, **/*.iws" />
    </copy>
    <copy todir="${deploy.dir}/MPS/samples.zip.tmp/MPSSamples">
      <fileset dir="${mps_home}/samples" excludes="**/*.iml, **/*.iws" />
    </copy>
    <zip destfile="${deploy.dir}/MPS/samples.zip" duplicate="preserve" filesonly="true">
      <zipfileset dir="${deploy.dir}/MPS/samples.zip.tmp" excludes="**/*.iml, **/*.iws" />
    </zip>
    <delete dir="${deploy.dir}/MPS/samples.zip.tmp" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xmlQuery.runtime_a5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.ide.uiLanguage.runtime_b5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage_a2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguageInternal_b2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.blTypes_c2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.builders_d2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.checkedDots_e2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.classifiers_f2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.closures_g2f0" />
    <antcall target="MPS-languages.pack.closures.runtime_h2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.collections_i2f0" />
    <antcall target="MPS-languages.pack.collections.runtime_j2f0" />
    <antcall target="MPS-languages.pack.collections_trove.runtime_k2f0" />
    <antcall target="MPS-languages.pack.collections_samples_l2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.dates_m2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.datesInternal_n2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.dates.runtime_o2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.javadoc_p2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.logging_q2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.math_r2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.money_s2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.refactoring_t2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.search_u2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.unitTest_v2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.unitTest.runtime_w2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.unitTest.lib_x2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.test_y2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.tuples_z2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.tuples.runtime_ab2f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.runConfigurations_bb2f0" />
    <mkdir dir="${deploy.dir}/MPS/core/baseLanguage" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.actions_a3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.annotations_b3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.behavior_c3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.constraints_d3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.editor.editorTest_e3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.editor_f3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.editor.runtime_g3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.findUsages_h3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.typesystem_i3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.intentions_j3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.dataFlow_k3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.dataFlow.runtime_l3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mpslite_m3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.nanoj_n3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.pattern_o3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.quotation_p3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.plugin_q3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.sharedConcepts_r3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.smodel_s3f0" />
    <antcall target="MPS-languages.pack.runtime_t3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.script_u3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.structure_v3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.core_w3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.refactoring_x3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.generator_y3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.generator.generationContext_z3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.test_ab3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.test.runtime_bb3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.textGen_cb3f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.lang.stubs_db3f0" />
    <mkdir dir="${deploy.dir}/MPS/core/languageDesign" />
    <antcall target="MPS-languages.pack.jetbrains.mps.devkit.general-purpose_a4f0" />
    <antcall target="MPS-languages.pack.jetbrains.mps.devkit.language-design_b4f0" />
    <mkdir dir="${deploy.dir}/MPS/core/devkits" />
    <antcall target="MPS-languages.pack.jetbrains.mps.debug.api.info_f5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.debug.evaluation_g5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.debug.evaluation.ui_h5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.debug.customViewers_i5a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.kernel_j5a" />
    <mkdir dir="${deploy.dir}/MPS/core" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xml.deprecated_a6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.uiLanguage_b6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.ide.uiLanguage_c6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.buildlanguage_d6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.custommps_e6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.custommpsInternal_f6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.distrib_g6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.generictasks_h6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.packaging_i6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.dependency_j6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.build.property_k6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xml_l6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xmlQuery_m6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xmlInternal_n6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xmlSchema_o6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.xmlUnitTest_p6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.regexp_q6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.regexp.examples_r6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.methodExtension_s6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.collections.trove_t6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.contracts_u6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.overloadedOperators_v6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.baseLanguage.constructors_w6a" />
    <antcall target="MPS-languages.pack.ypath.main_x6a" />
    <antcall target="MPS-languages.pack.ypath.test_y6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.ypath_z6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.bash_ab6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.quickQueryLanguage_bb6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.gwt.client_cb6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.gtext_db6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.gtext.runtime_eb6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.analyzers_fb6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.analyzers.runtime_gb6a" />
    <antcall target="MPS-languages.pack.jetbrains.mps.analyzers.mpsAnalyzers_hb6a" />
    <copy todir="${deploy.dir}/MPS/platform/generate.ant.task.jar.tmp">
      <fileset dir="${mps_home}/platform/buildlanguage/ant/classes" includes="**/*.class, **/*.xml, " />
    </copy>
    <jar destfile="${deploy.dir}/MPS/platform/generate.ant.task.jar" duplicate="preserve" filesonly="true">
      <fileset dir="${deploy.dir}/MPS/platform/generate.ant.task.jar.tmp" />
    </jar>
    <delete dir="${deploy.dir}/MPS/platform/generate.ant.task.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS/platform" />
    <copy todir="${deploy.dir}/MPS/plugin">
      <fileset dir="${mps_home}/plugin" excludes="**/*.java, **/*.iml, **/*.iws" />
    </copy>
    <antcall target="MPS-languages.pack.jetbrains.mps.ide_a8a" />
    <mkdir dir="${deploy.dir}/MPS/workbench" />
    <antcall target="MPS-languages.pack.youtrack-customfields-common-rest_a9a" />
    <mkdir dir="${deploy.dir}/MPS/custom-fields-rest" />
    <antcall target="MPS-languages.pack.jetbrains.youtrack.workflow_a01a" />
    <antcall target="MPS-languages.pack.jetbrains.youtrack.workflow.designtime_b01a" />
    <mkdir dir="${deploy.dir}/MPS/youtrack-workflow" />
    <echo file="${deploy.dir}/MPS/help-build.append.idea.version/build.number">build.number=${build.number}${line.separator}date=${DSTAMP}${line.separator}revision.number=${build.vcs.number}${line.separator}configuration.name=${teamcity.buildConfName}${line.separator}version=${version}</echo>
    <antcall target="help-build.append.idea.version" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS/help-build.append.idea.version" />
      <param name="output.dir" value="${deploy.dir}/MPS" />
      <param name="basedir" value="${basedir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS/help-build.append.idea.version" />
    <copy file="${mps_home}/readme.txt" tofile="${deploy.dir}/MPS/readme.txt" />
    <copy file="${mps_home}/releaseNotes.txt" tofile="${deploy.dir}/MPS/releaseNotes.txt" />
    <copy file="${mps_home}/about.txt" tofile="${deploy.dir}/MPS/about.txt" />
    <mkdir dir="${deploy.dir}/MPS" />
    <copy todir="${deploy.dir}/MPS-buildTools.zip.tmp/tools">
      <fileset dir="${mps_home}/build/tools" excludes="**/SignCode.exe, **/sign.code.jar, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-buildTools.zip.tmp/resources">
      <fileset dir="${mps_home}/build/resources" excludes="**/*.spc, **/*.pvk, **/*.pw, " />
    </copy>
    <zip destfile="${deploy.dir}/MPS-buildTools.zip" duplicate="preserve" filesonly="true">
      <zipfileset dir="${deploy.dir}/MPS-buildTools.zip.tmp" />
    </zip>
    <delete dir="${deploy.dir}/MPS-buildTools.zip.tmp" />
    <copy file="${mps_home}/lib/jetbrains-ideframework/idea-platform-src.zip" tofile="${deploy.dir}/idea-platform-src.zip" />
    <antcall target="help-build.pack.mps.src" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/help-build.pack.mps.src" />
      <param name="output.dir" value="${deploy.dir}/" />
      <param name="basedir" value="${basedir}" />
    </antcall>
    <delete dir="${deploy.dir}/help-build.pack.mps.src" />
  </target>
  <target name="clean.after" depends="do.the.job">
    <delete dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" />
    <delete dir="${deploy.dir}/MPS/samples.zip.tmp" />
    <delete dir="${deploy.dir}/MPS-buildTools.zip.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/idea-patch.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/platform/generate.ant.task.jar.tmp" />
  </target>
  <target name="replace_a7a13b0">
    <fail unless="mps_home" message="Property mps_home unspecified." />
    <copy file="${mps_home}/core/kernel/classes/idea/MPSApplicationInfo.xml" tofile="${deploy.dir}/MPS/lib/mps.jar.tmp/idea/MPSApplicationInfo.xml" />
    <replace file="${deploy.dir}/MPS/lib/mps.jar.tmp/idea/MPSApplicationInfo.xml" token="__BUILD_NUMBER__" value="${build.number}" />
    <replace file="${deploy.dir}/MPS/lib/mps.jar.tmp/idea/MPSApplicationInfo.xml" token="__BUILD_DATE__" value="${DSTAMP}" />
    <replace file="${deploy.dir}/MPS/lib/mps.jar.tmp/idea/MPSApplicationInfo.xml" token="__VERSION__" value="${version}" />
  </target>
</project>
