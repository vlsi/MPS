package jetbrains.mps.execution.configurations.implementation.plugin.plugin;

/*Generated by MPS */

import javax.swing.JPanel;
import javax.swing.JCheckBox;
import jetbrains.mps.execution.lib.ui.FieldWithPathChooseDialog;
import java.awt.GridBagLayout;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import com.intellij.openapi.fileChooser.FileChooserDescriptor;
import com.intellij.openapi.vfs.VirtualFile;
import jetbrains.mps.project.MPSExtentions;
import jetbrains.mps.ide.common.LayoutUtil;
import javax.swing.JLabel;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import jetbrains.mps.baseLanguage.tuples.runtime.MultiTuple;

/*package*/ class ProjectChooser extends JPanel {
  private final JCheckBox myOpenCurrentProject;
  private final FieldWithPathChooseDialog myProjectPath;

  public ProjectChooser() {
    super(new GridBagLayout());

    myOpenCurrentProject = new JCheckBox("Open Current Project");
    myOpenCurrentProject.addActionListener(new ActionListener() {
      @Override
      public void actionPerformed(ActionEvent p0) {
        myProjectPath.setEditable(!(myOpenCurrentProject.isSelected()));
      }
    });
    myProjectPath = new FieldWithPathChooseDialog(new FileChooserDescriptor(true, false, false, false, false, false) {
      @Override
      public boolean isFileVisible(VirtualFile file, boolean b) {
        if (!(super.isFileVisible(file, b))) {
          return false;
        }
        return file.isDirectory() || file.getName().endsWith(MPSExtentions.DOT_MPS_PROJECT);
      }
    });

    this.add(myOpenCurrentProject, LayoutUtil.createLabelConstraints(0));
    this.add(new JLabel("Project To Open:"), LayoutUtil.createLabelConstraints(1));
    this.add(myProjectPath, LayoutUtil.createFieldConstraints(2));
  }

  public void reset(boolean openCurrentProject, String pathToProject) {
    myOpenCurrentProject.setSelected(openCurrentProject);
    myProjectPath.setEditable(!(openCurrentProject));
    myProjectPath.setText(pathToProject);
  }

  public Tuples._2<Boolean, String> getValue() {
    return MultiTuple.<Boolean,String>from(myOpenCurrentProject.isSelected(), myProjectPath.getText());
  }
}
